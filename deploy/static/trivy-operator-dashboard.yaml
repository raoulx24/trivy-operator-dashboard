---
# Source: trivy-operator-dashboard/templates/serviceaccount.yaml
apiVersion: v1
kind: ServiceAccount
metadata:
  name: trivy-operator-dashboard
  labels:
    helm.sh/chart: trivy-operator-dashboard-0.1.0
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
    app.kubernetes.io/version: "0.9"
    app.kubernetes.io/managed-by: Helm
---
# Source: trivy-operator-dashboard/templates/clusterrole.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: trivy-operator-dashboard
rules:
- apiGroups: [""]
  resources: ["namespaces"]
  verbs: ["get", "watch", "list"]
- apiGroups: ["aquasecurity.github.io"]
  resources: ["*"]
  verbs: ["get", "watch", "list"]
---
# Source: trivy-operator-dashboard/templates/clusterrolebinding.yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: trivy-operator-dashboard
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: trivy-operator-dashboard
subjects:
- kind: ServiceAccount
  name: trivy-operator-dashboard
  namespace: default
---
# Source: trivy-operator-dashboard/templates/service.yaml
apiVersion: v1
kind: Service
metadata:
  name: trivy-operator-dashboard
  labels:
    helm.sh/chart: trivy-operator-dashboard-0.1.0
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
    app.kubernetes.io/version: "0.9"
    app.kubernetes.io/managed-by: Helm
spec:
  type: ClusterIP
  ports:
    - port: 8900
      targetPort: http
      protocol: TCP
      name: http
  selector:
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
---
# Source: trivy-operator-dashboard/templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: trivy-operator-dashboard
  labels:
    helm.sh/chart: trivy-operator-dashboard-0.1.0
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
    app.kubernetes.io/version: "0.9"
    app.kubernetes.io/managed-by: Helm
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: trivy-operator-dashboard
      app.kubernetes.io/instance: trivy-operator-dashboard
  template:
    metadata:
      labels:
        helm.sh/chart: trivy-operator-dashboard-0.1.0
        app.kubernetes.io/name: trivy-operator-dashboard
        app.kubernetes.io/instance: trivy-operator-dashboard
        app.kubernetes.io/version: "0.9"
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/component: web
        app.kubernetes.io/part-of: trivy-operator
    spec:
      serviceAccountName: trivy-operator-dashboard
      securityContext:
        {}
      containers:
      - name: trivy-operator-dashboard
        securityContext:
          {}
        image: "ghcr.io/raoulx24/trivydashboard:latest"
        imagePullPolicy: Always
        env:
        - name: KUBERNETES__KUBECONFIGFILENAME
          value: 
        - name: KUBERNETES__NAMESPACELIST
          value: 
        - name: KUBERNETES__TRIVYUSECLUSTERRBACASSESSMENTREPORT
          value: "true"
        - name: KUBERNETES__TRIVYUSECONFIGAUDITREPORT
          value: "true"
        - name: KUBERNETES__TRIVYUSEEXPOSEDSECRETREPORT
          value: "true"
        - name: KUBERNETES__TRIVYUSEVULNERABILITYREPORT
          value: "true"
        - name: SERILOG__MINIMUMLEVEL__DEFAULT
          value: Information
        - name: ASPNETCORE_URLS
          value: http://+:8900
        ports:
        - name: http
          containerPort: 8900
          protocol: TCP
        livenessProbe:
          httpGet:
            path: /
            port: http
        readinessProbe:
          httpGet:
            path: /
            port: http
        resources:
          {}
---
# Source: trivy-operator-dashboard/templates/ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: trivy-operator-dashboard
  labels:
    helm.sh/chart: trivy-operator-dashboard-0.1.0
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
    app.kubernetes.io/version: "0.9"
    app.kubernetes.io/managed-by: Helm
spec:
  ingressClassName: nginx
  rules:
    - host: "chart-example.local"
      http:
        paths:
          - path: /
            pathType: ImplementationSpecific
            backend:
              service:
                name: trivy-operator-dashboard
                port:
                  number: 8900
---
# Source: trivy-operator-dashboard/templates/tests/test-connection.yaml
apiVersion: v1
kind: Pod
metadata:
  name: "trivy-operator-dashboard-test-connection"
  labels:
    helm.sh/chart: trivy-operator-dashboard-0.1.0
    app.kubernetes.io/name: trivy-operator-dashboard
    app.kubernetes.io/instance: trivy-operator-dashboard
    app.kubernetes.io/version: "0.9"
    app.kubernetes.io/managed-by: Helm
  annotations:
    "helm.sh/hook": test
spec:
  containers:
    - name: wget
      image: busybox
      command: ['wget']
      args: ['trivy-operator-dashboard:8900']
  restartPolicy: Never
