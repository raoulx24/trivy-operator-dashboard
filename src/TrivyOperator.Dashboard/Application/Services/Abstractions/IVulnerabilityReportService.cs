using TrivyOperator.Dashboard.Application.Models;
using TrivyOperator.Dashboard.Domain.Trivy.VulnerabilityReport;

namespace TrivyOperator.Dashboard.Application.Services.Abstractions;

public interface IVulnerabilityReportService
{
    Task<IList<VulnerabilityReportDto>> GetVulnerabilityReportDtos();
    Task<IList<VulnerabilityReportDto>> GetVulnerabilityReportDtos(string namespaceName);
    Task<VulnerabilityReportDto?> GetVulnerabilityReportDtoByUid(Guid uid);
    Task<IList<VulnerabilityReportDenormalizedDto>> GetVulnerabilityReportDenormalizedDtos();
    Task<IList<VulnerabilityReportDenormalizedDto>> GetVulnerabilityReportDenormalizedDtos(string namespaceName);
    Task<IEnumerable<string>> GetActiveNamespaces();
    Task<VulnerabilityReportSumaryDto> GetVulnerabilityReportSummaryDtos();
    Task<IEnumerable<VulnerabilityReportImageDto>> GetVulnerabilityReportImageDtos(string? namespaceName = null, IEnumerable<int>? excludedSeverities = null);
}
