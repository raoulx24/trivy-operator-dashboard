using TrivyOperator.Dashboard.Application.Services.BackgroundQueues.Abstractions;
using TrivyOperator.Dashboard.Application.Services.CacheRefresh.Abstractions;
using TrivyOperator.Dashboard.Application.Services.CacheWatcherEventHandlers.Abstractions;
using TrivyOperator.Dashboard.Application.Services.WatcherEvents.Abstractions;
using TrivyOperator.Dashboard.Application.Services.Watchers.Abstractions;
using TrivyOperator.Dashboard.Domain.Trivy.CustomResources.Abstractions;
using TrivyOperator.Dashboard.Domain.Trivy.VulnerabilityReport;

namespace TrivyOperator.Dashboard.Application.Services.CacheWatcherEventHandlers;

public class VulnerabilityReportCacheWatcherEventHandler(
    ICacheRefresh<VulnerabilityReportCr, IBackgroundQueue<VulnerabilityReportCr>> cacheRefresh,
    INamespacedWatcher<VulnerabilityReportCr> kubernetesWatcher,
    ILogger<VulnerabilityReportCacheWatcherEventHandler> logger)
    : NamespacedCacheWatcherEventHandler<IBackgroundQueue<VulnerabilityReportCr>,
        ICacheRefresh<VulnerabilityReportCr, IBackgroundQueue<VulnerabilityReportCr>>,
        WatcherEvent<VulnerabilityReportCr>, INamespacedWatcher<VulnerabilityReportCr>, VulnerabilityReportCr,
        CustomResourceList<VulnerabilityReportCr>>(cacheRefresh, kubernetesWatcher, logger);
