using TrivyOperator.Dashboard.Application.Models;

namespace TrivyOperator.Dashboard.Application.Services.Trivy.VulnerabilityReport.Abstractions;

public interface IVulnerabilityReportService
{
    Task<IEnumerable<VulnerabilityReportDto>> GetVulnerabilityReportDtos(string? namespaceName = null);
    Task<VulnerabilityReportDto?> GetVulnerabilityReportDtoByUid(Guid uid);

    Task<IEnumerable<VulnerabilityReportDenormalizedDto>> GetVulnerabilityReportDenormalizedDtos(string? namespaceName = null);

    Task<IEnumerable<string>> GetActiveNamespaces();
    Task<VulnerabilityReportSummaryDto> GetVulnerabilityReportSummaryDtos();

    Task<IEnumerable<VulnerabilityReportImageDto>> GetVulnerabilityReportImageDtos(
        string? namespaceName = null,
        IEnumerable<int>? excludedSeverities = null);

    Task<VulnerabilityReportImageDto?> GetVulnerabilityReportImageDtoByDigestNamespace(string digest, string namespaceName);
}
