using System.Text.Json.Serialization;

namespace TrivyOperator.Dashboard.Domain.Trivy.VulnerabilityReport;

public class Vulnerability
{
    [JsonPropertyName("fixedVersion")]
    public string? FixedVersion { get; set; }

    [JsonPropertyName("installedVersion")]
    public string? InstalledVersion { get; set; }

    [JsonPropertyName("lastModifiedDate")]
    public DateTime LastModifiedDate { get; set; }

    [JsonPropertyName("links")]
    public object[]? Links { get; set; }

    [JsonPropertyName("primaryLink")]
    public Uri? PrimaryLink { get; set; }

    [JsonPropertyName("publishedDate")]
    public DateTime PublishedDate { get; set; }

    [JsonPropertyName("resource")]
    public string? Resource { get; set; }

    [JsonPropertyName("score")]
    public double Score { get; set; }

    [JsonPropertyName("severity")]
    public TrivySeverity TrivySeverity { get; set; }

    public string? Severity1 { get { return TrivySeverity.ToString(); } }

    [JsonPropertyName("target")]
    public string? Target { get; set; }

    [JsonPropertyName("title")]
    public string? Title { get; set; }

    [JsonPropertyName("vulnerabilityID")]
    public string? VulnerabilityId { get; set; }
}
