using System.Text.Json.Serialization;

namespace TrivyOperator.Dashboard.Domain.Trivy.VulnerabilityReport;

public class Vulnerability
{
    [JsonPropertyName("fixedVersion")]
    public string FixedVersion { get; init; } = string.Empty;

    [JsonPropertyName("installedVersion")]
    public string InstalledVersion { get; init; } = string.Empty;

    [JsonPropertyName("lastModifiedDate")]
    public DateTime? LastModifiedDate { get; init; }

    [JsonPropertyName("links")]
    public object[] Links { get; init; } = [];

    [JsonPropertyName("packagePURL")]
    public string PackagePurl { get; init; } = string.Empty;

    [JsonPropertyName("primaryLink")]
    public Uri? PrimaryLink { get; init; }

    [JsonPropertyName("publishedDate")]
    public DateTime? PublishedDate { get; init; }

    [JsonPropertyName("resource")]
    public string Resource { get; init; } = string.Empty;

    [JsonPropertyName("score")]
    public float Score { get; init; } = 0;

    [JsonPropertyName("severity")]
    public TrivySeverity Severity { get; init; }

    //public string? Severity1 { get { return TrivySeverity.ToString(); } }

    [JsonPropertyName("target")]
    public string Target { get; init; } = string.Empty;

    [JsonPropertyName("title")]
    public string Title { get; init; } = string.Empty;

    [JsonPropertyName("vulnerabilityID")]
    public string VulnerabilityId { get; init; } = string.Empty;
}
