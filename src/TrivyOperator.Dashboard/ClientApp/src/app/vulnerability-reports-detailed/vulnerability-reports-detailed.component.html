<h3 id="tableLabel">Vulnerability Reports Detailed</h3>

<p-tag [value]="getSeverityCssColor('HIGH')" [style]="{ background: getSeverityCssColor('HIGH') }" />
<!--</p-tag>-->

<p *ngIf="!vulnerabilityReportsDetailedDtos"><em>Loading...</em></p>

<ag-grid-angular (gridReady)="onGridReady($event)"
                  *ngIf="vulnerabilityReportsDetailedDtos"
                  [columnDefs]="columnDefs"
                  [defaultColDef]="defaultColDef"
                  [rowData]="vulnerabilityReportsDetailedDtos"
                  [rowSelection]="rowSelection"
                  class="ag-theme-quartz-auto-dark"
                  style="height: 30vh;">
</ag-grid-angular>

<p>{{ selectedTest }}</p>
<p-multiSelect [options]="test"
               [(ngModel)]="selectedTest"
               placeholder="Select Somethin'"
               [style]="{'width':'400px'}"
               [maxSelectedLabels]="2">
  <ng-template let-plix pTemplate="selectedItems" [maxSelectedLabels]="2">
    <!--<div class="inline-flex align-items-center gap-2 px-1" *ngFor="let something1 of plix">-->
      <div>{{ getSeverityCssColors(plix, 1) }}</div>
    <!--</div>-->
    <div *ngIf="!plix || plix.length === 0">Select Severities</div>
  </ng-template>
  <ng-template let-something pTemplate="item">
    <div class="flex align-items-center gap-2">{{ getSeverityCssColor(something) }}-{{ something }}</div>
  </ng-template>
</p-multiSelect>

<p-multiSelect [options]="test"
               [(ngModel)]="selectedTest"
               placeholder="Select Somethin'"
               [style]="{'width':'500px'}"
               [maxSelectedLabels]="2">
</p-multiSelect>

<p-table [value]="vulnerabilityReportsDetailedDtos!"
         [scrollable]="true"
         scrollHeight="400px"
         [virtualScroll]="true"
         [virtualScrollItemSize]="46"
         [tableStyle]="{ 'min-width': '50rem', 'font-size':'14px' }"
         styleClass="p-datatable-sm">
  <ng-template pTemplate="header">
    <tr>
      <th pSortableColumn="resourceNamespace">
        Namespace<p-sortIcon field="resourceNamespace" />
      </th>
      <th>Container</th>
      <th>Image Name - Tag</th>
      <th pSortableColumn="imageName">
        Severity<p-sortIcon field="imageName" />
      </th>
      <th>Tiltle</th>
      <th>CVE</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-vrdDto>
    <tr style="height:46px">
      <td>{{ vrdDto.resourceNamespace
  }}</td>
  <td>{{ vrdDto.resourceContainerName }}</td>
  <td>{{ vrdDto.imageName }}:{{ vrdDto.imageTag }}</td>
  <td><p-tag [value]="getSeverityShortName(vrdDto.severity)" [style]="{ background: getSeverityCssColor(vrdDto.severity) }" /></td>
  <td>{{ vrdDto.title }}</td>
  <td><a href="{{ vrdDto.primaryLink }}" target="_blank">{{ vrdDto.vulnerabilityId }}</a></td>
  </tr>
  </ng-template>
  <ng-template pTemplate="summary">
    <div>
      Total of Vulnerability Report Details {{vulnerabilityReportsDetailedDtos ? vulnerabilityReportsDetailedDtos.length : 0 }}.
    </div>
  </ng-template>
  </p-table>

  <div style="margin: 10px 0;">
    <button type="button" class="btn btn-primary" (click)="onBtnExport()">Download CSV export file</button>
  </div>
