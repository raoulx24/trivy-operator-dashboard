<h3 id="tableLabel">Vulnerability Reports Detailed</h3>

<p-tag [value]="getSeverityCssColor('HIGH')" [style]="{ background: getSeverityCssColor('HIGH') }" />
  <!--</p-tag>-->

  <p *ngIf="!vulnerabilityReportsDetailedDtos"><em>Loading...</em></p>

  <ag-grid-angular (gridReady)="onGridReady($event)"
                   *ngIf="vulnerabilityReportsDetailedDtos"
                   [columnDefs]="columnDefs"
                   [defaultColDef]="defaultColDef"
                   [rowData]="vulnerabilityReportsDetailedDtos"
                   [rowSelection]="rowSelection"
                   class="ag-theme-quartz-auto-dark"
                   style="height: 30vh;">
  </ag-grid-angular>

  <p-table [value]="vulnerabilityReportsDetailedDtos!"
           [scrollable]="true"
           scrollHeight="400px"
           [virtualScroll]="true"
           [virtualScrollItemSize]="46"
           [tableStyle]="{ 'min-width': '50rem', 'font-size':'14px' }"
           styleClass="p-datatable-sm">
    <ng-template pTemplate="header">
      <tr>
        <th>Namespace</th>
        <th>Container</th>
        <th>Image Name - Tag</th>
        <th>Severity</th>
        <th>Tiltle</th>
        <th>CVE</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-vrdDto>
      <tr style="height:46px">
        <td>{{ vrdDto.resourceNamespace }}</td>
        <td>{{ vrdDto.resourceContainerName }}</td>
        <td>{{ vrdDto.imageName }}:{{ vrdDto.imageTag }}</td>
        <td><p-tag [value]="getSeverityShortName(vrdDto.severity)" [style]="{ background: getSeverityCssColor(vrdDto.severity) }"/></td>
        <td>{{ vrdDto.title }}</td>
        <td><a href="{{ vrdDto.primaryLink }}" target="_blank">{{ vrdDto.vulnerabilityId }}</a></td>
      </tr>
    </ng-template>
  </p-table>

  <div style="margin: 10px 0;">
    <button type="button" class="btn btn-primary" (click)="onBtnExport()">Download CSV export file</button>
  </div>
