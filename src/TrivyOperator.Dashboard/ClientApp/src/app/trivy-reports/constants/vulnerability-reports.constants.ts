import { TrivyTableColumn } from '../../ui-elements/trivy-table/trivy-table.types';

export const vulnerabilityReportColumns: readonly TrivyTableColumn[] = [
  {
    field: 'imageName',
    header: 'Image Name - Tag',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 265px; max-width: 265px; white-space: normal;',
    renderType: 'imageNameTag',
    extraFields: ['imageTag', 'imageEosl'],
  },
  {
    field: 'criticalCount',
    header: 'C',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 50px; max-width: 50px;',
    renderType: 'severityValue',
    extraFields: ['0'],
  },
  {
    field: 'highCount',
    header: 'H',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 50px;',
    renderType: 'severityValue',
    extraFields: ['1'],
  },
  {
    field: 'mediumCount',
    header: 'M',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 50px; max-width: 50px;',
    renderType: 'severityValue',
    extraFields: ['2'],
  },
  {
    field: 'lowCount',
    header: 'L',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 50px; max-width: 50px;',
    renderType: 'severityValue',
    extraFields: ['3'],
  },
  {
    field: 'unknownCount',
    header: 'U',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 50px; max-width: 50px;',
    renderType: 'severityValue',
    extraFields: ['4'],
  },
];

export const vulnerabilityReportDetailColumns: readonly TrivyTableColumn[] = [
  {
    field: 'severityId',
    header: 'Sev',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'severities',
    style: 'width: 90px; max-width: 90px;',
    renderType: 'severityBadge',
  },
  {
    field: 'resource',
    header: 'Resource',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 130px; max-width: 130px',
    renderType: 'standard',
  },
  {
    field: 'title',
    header: 'Title',
    isFilterable: true,
    isSortable: false,
    multiSelectType: 'none',
    style: 'min-with: 200px; white-space: normal;',
    renderType: 'standard',
  },
  {
    field: 'installedVersion',
    header: 'Installed Ver',
    isFilterable: true,
    isSortable: false,
    multiSelectType: 'none',
    style: 'width: 120px; max-width: 120px',
    renderType: 'standard',
  },
  {
    field: 'fixedVersion',
    header: 'Fixed Ver',
    isFilterable: true,
    isSortable: false,
    multiSelectType: 'none',
    style: 'width: 120px; max-width: 120px',
    renderType: 'standard',
  },
  {
    field: 'publishedDate',
    header: 'Publish',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 900px; max-width: 90px',
    renderType: 'date',
  },
  {
    field: 'lastModifiedDate',
    header: 'Modif',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 90px; max-width: 90px',
    renderType: 'date',
  },
  {
    field: 'score',
    header: 'Score',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 70px; max-width: 70px',
    renderType: 'standard',
  },
  {
    field: 'vulnerabilityId',
    header: 'CVE',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 150px; max-width: 150px;',
    renderType: 'link',
    extraFields: ['primaryLink'],
  },
];

export const vulnerabilityReportDenormalizedColumns: readonly TrivyTableColumn[] = [
  {
    field: 'resourceName',
    header: 'Name',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 280px; max-width: 280px;',
    renderType: 'standard',
  },
  {
    field: 'resourceKind',
    header: 'Kind',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 110px; max-width: 110px;',
    renderType: 'standard',
  },
  {
    field: 'resourceContainerName',
    header: 'Container',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 170px; max-width: 170px;',
    renderType: 'standard',
  },
  {
    field: 'imageName',
    header: 'Image',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 210px; max-width: 210px;',
    renderType: 'standard',
  },
  {
    field: 'imageTag',
    header: 'Tag',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 115px; max-width: 115px;',
    renderType: 'standard',
  },
  {
    field: 'imageDigest',
    header: 'Image Digest',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 550px; max-width: 550px;',
    renderType: 'standard',
  },
  {
    field: 'imageRepository',
    header: 'Repository',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 220px; max-width: 220px;',
    renderType: 'standard',
  },
  {
    field: 'imageOsFamily',
    header: 'OSFam',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 130px; max-width: 130px;',
    renderType: 'standard',
  },
  {
    field: 'imageOsName',
    header: 'OSName',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 130px; max-width: 130px;',
    renderType: 'standard',
  },
  {
    field: 'imageEosl',
    header: 'EOSL',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 110px; max-width: 110px;',
    renderType: 'eosl',
  },
  {
    field: 'updateTimestamp',
    header: 'Update Moment',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 140px; max-width: 140px;',
    renderType: 'dateTime',
  },
  {
    field: 'resource',
    header: 'Resource',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 150px; max-width: 150px;',
    renderType: 'standard',
  },
  {
    field: 'title',
    header: 'Title',
    isFilterable: false,
    isSortable: false,
    multiSelectType: 'none',
    style: 'width: 450px; max-width: 450px; white-space: normal;',
    renderType: 'standard',
  },
  {
    field: 'severityId',
    header: 'Sev',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'severities',
    style: 'width: 125px; max-width: 125px;',
    renderType: 'severityBadge',
  },
  {
    field: 'installedVersion',
    header: 'Installed Ver',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 150px; max-width: 150px;',
    renderType: 'standard',
  },
  {
    field: 'fixedVersion',
    header: 'Fixed Ver',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 150px; max-width: 150px;',
    renderType: 'standard',
  },
  {
    field: 'publishedDate',
    header: 'Publish',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 130px; max-width: 200px;',
    renderType: 'date',
  },
  {
    field: 'lastModifiedDate',
    header: 'Modif',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 130px; max-width: 200px;',
    renderType: 'date',
  },
  {
    field: 'score',
    header: 'Score',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 110px; max-width: 110px;',
    renderType: 'standard',
  },

  {
    field: 'vulnerabilityId',
    header: 'CVE',
    isFilterable: true,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 150px; max-width: 150px;',
    renderType: 'link',
    extraFields: ['primaryLink'],
  },
];

export const vulnerabilityReportComparedTableColumns: TrivyTableColumn[] = [
  {
    field: 'first',
    header: '1st',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 90px; max-width: 90px;',
    renderType: 'boolean',
  },
  {
    field: 'second',
    header: '2nd',
    isFilterable: false,
    isSortable: true,
    multiSelectType: 'none',
    style: 'width: 90px; max-width: 90px;',
    renderType: 'boolean',
  },
  ...vulnerabilityReportDetailColumns
    .map(col => ({
      ...col,
      renderType: col.field === 'installedVersion' ? 'compareStacked' : col.renderType
    })),
];
