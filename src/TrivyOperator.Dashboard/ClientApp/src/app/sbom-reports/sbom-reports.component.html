<h3>SBOM Reports</h3>

<div class="row">
  <div class="grid flex">
    <div class="col-12 md:col-5 lg:col-4 p-1">
      <div class="grid flex">
        <div class="col-4 p-fluid">
          <p-dropdown
            placeholder="Select a Namespace"
            class="p-inputtext-sm"
            [filter]="true"
            [options]="activeNamespaces"
            [showClear]="true"
            [(ngModel)]="selectedNamespace"
            (onChange)="filterImageDtos()"
          />
        </div>
        <div class="col-8 p-fluid">
          <p-dropdown
            optionLabel="imageNameTag"
            placeholder="Select a Namespace"
            class="p-inputtext-sm"
            [filter]="true"
            [options]="imageDtos"
            [showClear]="true"
            [(ngModel)]="selectedImageDto"
          />
        </div>
      </div>
      <!--<p-card [header]="selectedSbomDetailDto?.name ?? 'none'" [subheader]="selectedSbomDetailDto?.version ?? 'none'">-->
      <p-card styleClass="custom-card">
        <div class="flex flex-column pb-2">
          <span>{{ selectedSbomDetailDto?.name ?? 'none' }} - {{ selectedSbomDetailDto?.version ?? 'none' }}</span>
          <!--<span>{{ selectedSbomDetailDto?.purl ?? 'none' }}</span>-->
        </div>
        <p-table [value]="selectedSbomDetailDto?.properties || []"
                 [scrollable]="true"
                 scrollHeight="200px"
                 [resizableColumns]="true"
                 columnResizeMode="expand"
                 styleClass="p-datatable-sm text-xs">
          <!--<ng-template pTemplate="header">
            <tr>
              <th pResizableColumn>Name</th>
              <th pResizableColumn>Value</th>
            </tr>
          </ng-template>-->
          <ng-template pTemplate="body" let-rowData>
            <tr>
              <td style="white-space: pre-wrap; word-wrap: break-word; width: 100px; max-width: 100px;">
                {{ sanitizePropertyName(rowData[0].substring(19)) }}
              </td>
              <td style="white-space: pre-wrap; word-wrap: break-word;">
                {{ sanitizePropertyValue(rowData[1]) }}
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-card>
      <app-trivy-table
        tableHeight="30vh"
        [dataDtos]="dependsOnBoms!"
        [isLoading]="false"
        [trivyTableColumns]="dependsOnTableColumns"
        [trivyTableOptions]="dependsOnTableOptions"
      />
      <app-trivy-table
        *ngIf="false"
        #mainTable
        tableHeight="70vh"
        [activeNamespaces]="activeNamespaces"
        [dataDtos]="dataDtos!"
        [isLoading]="isMainTableLoading"
        [trivyTableColumns]="mainTableColumns"
        [trivyTableOptions]="mainTableOptions"
        (refreshRequested)="onRefreshRequested($event)"
        (selectedRowsChanged)="onMainTableSelectionChange($event)"
      />
    </div>
    <div class="col-12 md:col-7 lg:col-8 p-1">
      <app-fcose [dataDtos]="fullSbomDataDto?.details ?? []" [(selectedInnerNodeId)]="selectedInnerNodeId" />
    </div>
  </div>
</div>
