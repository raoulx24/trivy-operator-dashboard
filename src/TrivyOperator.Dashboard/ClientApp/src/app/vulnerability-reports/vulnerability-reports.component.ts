import { Component, ViewChild } from '@angular/core';
import { VulnerabilityReportsService } from "../../api/services/vulnerability-reports.service";
import { VulnerabilityReportSummaryDto } from "../../api/models/vulnerability-report-summary-dto";

import { ChartComponent } from "ng-apexcharts";
import { ApexNonAxisChartSeries, ApexResponsive, ApexChart } from "ng-apexcharts";

export type ChartOptions = {
  chart: ApexChart;
  responsive: ApexResponsive[];
  labels: any;
  colors: string[];
  legend: any;
};

@Component({
  selector: 'app-vulnerability-reports',
  templateUrl: './vulnerability-reports.component.html',
  styleUrl: './vulnerability-reports.component.scss'
})



export class VulnerabilityReportsComponent {
  public vulnerabilityReportSummaryDtos?: VulnerabilityReportSummaryDto[] | null | undefined;
  public chartOptions: ChartOptions;

  constructor(vulnerabilityReportsService: VulnerabilityReportsService) {
    this.chartOptions = {
      chart: {
        //width: 200,
        type: "pie",
      },
      labels: ["Critical", "High", "Medium", "Low", "Unknown"],
      colors: [
        this.getCssVariableValue('--bs-danger'),
        this.getCssVariableValue('--bs-warning'),
        this.getCssVariableValue('--bs-secondary'),
        this.getCssVariableValue('--bs-info'),
        this.getCssVariableValue('--bs-primary')],
      responsive: [
        //{
        //  breakpoint: 480,
        //  options: {
        //    chart: {
        //      width: 200
        //    },
        //    legend: {
        //      position: "bottom"
        //    }
        //  }
        //}
      ],
      legend: { show: false },
    };
    vulnerabilityReportsService.getVulnerabilityReportSummaryDtos().subscribe(result => this.vulnerabilityReportSummaryDtos = result, error => console.error(error));

  }

  getCssVariableValue(variableName: string): string {
    return getComputedStyle(document.documentElement).getPropertyValue(variableName).trim();
  }

}
