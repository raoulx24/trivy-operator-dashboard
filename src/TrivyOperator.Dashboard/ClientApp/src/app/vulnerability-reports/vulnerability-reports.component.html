<h3>Vulnerability Reports</h3>

<app-generic-master-detail #genericMasterDetail
                           [dataDtos]="vulnerabilityReportDtos"
                           [severityDtos]="severityDtos"
                           [activeNamespaces]="activeNamespaces"
                           [mainTableColumns]="mainTableColumns"
                           [mainTableOptions]="mainTableOptions"
                           [mainTableExpandTableOptions]="mainTableExpandTableOptions"
                           [mainTableExpandCellOptions]="mainTableExpandCellOptions"
                           [isMainTableLoading]="isMainTableLoading"
                           [detailsTableColumns]="detailsTableColumns"
                           [detailsTableOptions]="detailsTableOptions"
                           (refreshRequested)="onRefreshRequested($event)"
                           (mainTableExpandCallback)="onMainTableExpandCallback($event)" />

<p-dialog *ngIf="mainTableExpandCallbackDto && mainTableExpandCallbackDto.resources"
          [header]="getPanelHeaderText()"
          [modal]="true"
          [(visible)]="isImageUsageDialogVisible"
          closable="true"
          closeOnEscape="true"
          dismissableMask="true"
          resizable="true"
          [contentStyle]="{ 'height': '60vh'}"
          [breakpoints]="{ '890px': '90vw' }"
          [style]="{ width: '50rem' }">
  <p-table [value]="mainTableExpandCallbackDto!.resources!"
           [scrollable]="true"
           scrollHeight="flex"
           sortMode="multiple"
           styleClass="p-datatable-sm text-sm p-0">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="name" style="width:55%">
          Resource Name
          <p-sortIcon field="name" />
        </th>
        <th pSortableColumn="kind" style="width:20%">
          Kind
          <p-sortIcon field="kind" />
        </th>
        <th pSortableColumn="containerName" style="width:25%">
          Container
          <p-sortIcon field="containerName" />
        </th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-resource>
      <tr>
        <td style="width: 55%;">
          {{ resource.name }}
        </td>
        <td style="width: 20%;">
          {{ resource.kind }}
        </td>
        <td style="width:25%;">
          {{ resource.containerName }}
        </td>
      </tr>
    </ng-template>
  </p-table>
</p-dialog>
